{"remainingRequest":"/Users/pantu/.npm/_npx/64608/lib/node_modules/@vizia/app-emulator/node_modules/babel-loader/lib/index.js??ref--4-1!/Users/pantu/work2/vizia-ig-app/src/lib/si-source.js","dependencies":[{"path":"/Users/pantu/work2/vizia-ig-app/src/lib/si-source.js","mtime":1664896491595},{"path":"/Users/pantu/.npm/_npx/64608/lib/node_modules/@vizia/app-emulator/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/pantu/.npm/_npx/64608/lib/node_modules/@vizia/app-emulator/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKY29uc3QgYXhpb3MgPSByZXF1aXJlKCdheGlvcycpOwpjb25zdCB7CiAgcGxhdGZvcm1zLAogIGJ1aWxkSnNvbiwKICB2YWxpZGF0ZUFjY291bnQsCiAgd3JpdGVNYW5pZmVzdAp9ID0gcmVxdWlyZSgnLi4vbWFuaWZlc3RXcml0ZXInKTsKY29uc3QgX19BUElfQUREUiA9ICdodHRwOi8vbG9jYWxob3N0OjYwMDEvZ29vZ2xlZGF0YXN0dWRpbz9tZXRob2Q9cHJvZmlsZXNfYWdncmVnYXRlZF9tZXRyaWNzJzsKLy8gY29uc3QgX19BUElfQUREUiA9ICdodHRwczovL2FwaS5zb2NpYWxpbnNpZGVyLmlvL2dvb2dsZWRhdGFzdHVkaW8/bWV0aG9kPXByb2ZpbGVzX2FnZ3JlZ2F0ZWRfbWV0cmljcyc7Cgpjb25zdCBwbGF0Zm9ybXNBbGlhcyA9IHsKICAnZmFjZWJvb2snOiAnZmInLAogICdpbnN0YWdyYW0nOiAnaWcnLAogICd0aWt0b2snOiAndGsnLAogICdsaW5rZWRpbic6ICdsaScsCiAgJ3R3aXR0ZXInOiAndHcnLAogICd5b3V0dWJlJzogJ3l0Jwp9Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICBsZXQgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgcmV0dXJuIHsKICAgIHNvdXJjZShwaXBlbGluZSkgewogICAgICBjb25zdCBwcm9wcyA9IHBpcGVsaW5lLmNvbmZpZy5zY2VuZS5vcHRpb25zOwogICAgICBjb25zdCB7CiAgICAgICAga2V5LAogICAgICAgIHByb2ZpbGUsCiAgICAgICAgcHJvamVjdAogICAgICB9ID0gcHJvcHM7CiAgICAgIGxldCBwbGF0Zm9ybSA9ICdpbnN0YWdyYW0nOwogICAgICBjb25zdCB1cmwgPSBgJHtfX0FQSV9BRERSfSZrZXk9JHtrZXl9JnByb2plY3Q9JHtwcm9qZWN0fSZwbGF0Zm9ybT0ke3BsYXRmb3Jtc0FsaWFzW3BsYXRmb3JtXX0mcHJvZmlsZXM9W3slMjJpZCUyMjolMjIke3Byb2ZpbGV9JTIyLCUyMnBsYXRmb3JtJTIyOiUyMiR7cGxhdGZvcm1zQWxpYXNbcGxhdGZvcm1dfSUyMn1dYDsKICAgICAgY29uc29sZS5sb2codXJsKTsKICAgICAgYXhpb3ModXJsKS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmRhdGEpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHJlc3BvbnNlID0gcmVzcG9uc2UuYmVuY2htYXJrX2RhdGEuZmlsdGVyKHIgPT4gci5uYW1lID09PSBwcm9maWxlKVswXTsKICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgcGlwZWxpbmUucHVzaChyZXNwb25zZSk7CiAgICAgICAgcGlwZWxpbmUuZG9uZSgpOwogICAgICB9KTsKICAgIH0KICB9Owp9Ow=="},{"version":3,"names":["axios","require","platforms","buildJson","validateAccount","writeManifest","__API_ADDR","platformsAlias","module","exports","options","source","pipeline","props","config","scene","key","profile","project","platform","url","console","log","then","response","data","benchmark_data","filter","r","name","push","done"],"sources":["/Users/pantu/work2/vizia-ig-app/src/lib/si-source.js"],"sourcesContent":["'use strict'\nconst axios = require('axios');\nconst { platforms,\n    buildJson,\n    validateAccount,\n    writeManifest }  = require('../manifestWriter');\n\nconst __API_ADDR = 'http://localhost:6001/googledatastudio?method=profiles_aggregated_metrics';\n// const __API_ADDR = 'https://api.socialinsider.io/googledatastudio?method=profiles_aggregated_metrics';\n\nconst platformsAlias = {\n    'facebook': 'fb',\n    'instagram': 'ig',\n    'tiktok': 'tk',\n    'linkedin': 'li',\n    'twitter': 'tw',\n    'youtube': 'yt'\n}\n\nmodule.exports = (options = {}) => {\n    return {\n        source(pipeline) {\n            const props = pipeline.config.scene.options; \n            const {key, profile, project} = props;\n\n            let platform = 'instagram';\n            const url = `${__API_ADDR}&key=${key}&project=${project}&platform=${platformsAlias[platform]}&profiles=[{%22id%22:%22${profile}%22,%22platform%22:%22${platformsAlias[platform]}%22}]`;\n            console.log(url);\n\n            axios(url)\n                .then(response => response.data)\n                .then((response) => {\n                    response = response.benchmark_data.filter(r => r.name === profile)[0];\n                    console.log(response);\n                    pipeline.push(response);\n                    pipeline.done();\n                });\n        }\n    }\n}"],"mappings":"AAAA,YAAY;;AACZ,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAO,CAAC;AAC9B,MAAM;EAAEC,SAAS;EACbC,SAAS;EACTC,eAAe;EACfC;AAAc,CAAC,GAAIJ,OAAO,CAAC,mBAAmB,CAAC;AAEnD,MAAMK,UAAU,GAAG,2EAA2E;AAC9F;;AAEA,MAAMC,cAAc,GAAG;EACnB,UAAU,EAAE,IAAI;EAChB,WAAW,EAAE,IAAI;EACjB,QAAQ,EAAE,IAAI;EACd,UAAU,EAAE,IAAI;EAChB,SAAS,EAAE,IAAI;EACf,SAAS,EAAE;AACf,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAG,YAAkB;EAAA,IAAjBC,OAAO,uEAAG,CAAC,CAAC;EAC1B,OAAO;IACHC,MAAM,CAACC,QAAQ,EAAE;MACb,MAAMC,KAAK,GAAGD,QAAQ,CAACE,MAAM,CAACC,KAAK,CAACL,OAAO;MAC3C,MAAM;QAACM,GAAG;QAAEC,OAAO;QAAEC;MAAO,CAAC,GAAGL,KAAK;MAErC,IAAIM,QAAQ,GAAG,WAAW;MAC1B,MAAMC,GAAG,GAAI,GAAEd,UAAW,QAAOU,GAAI,YAAWE,OAAQ,aAAYX,cAAc,CAACY,QAAQ,CAAE,2BAA0BF,OAAQ,yBAAwBV,cAAc,CAACY,QAAQ,CAAE,OAAM;MACtLE,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;MAEhBpB,KAAK,CAACoB,GAAG,CAAC,CACLG,IAAI,CAACC,QAAQ,IAAIA,QAAQ,CAACC,IAAI,CAAC,CAC/BF,IAAI,CAAEC,QAAQ,IAAK;QAChBA,QAAQ,GAAGA,QAAQ,CAACE,cAAc,CAACC,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKZ,OAAO,CAAC,CAAC,CAAC,CAAC;QACrEI,OAAO,CAACC,GAAG,CAACE,QAAQ,CAAC;QACrBZ,QAAQ,CAACkB,IAAI,CAACN,QAAQ,CAAC;QACvBZ,QAAQ,CAACmB,IAAI,EAAE;MACnB,CAAC,CAAC;IACV;EACJ,CAAC;AACL,CAAC"}]}