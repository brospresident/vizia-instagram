{"remainingRequest":"/Users/pantu/.npm/_npx/64608/lib/node_modules/@vizia/app-emulator/node_modules/babel-loader/lib/index.js??ref--4-1!/Users/pantu/work2/vizia-ig-app/src/lib/create-key-metric-transform.js","dependencies":[{"path":"/Users/pantu/work2/vizia-ig-app/src/lib/create-key-metric-transform.js","mtime":1664898417232},{"path":"/Users/pantu/.npm/_npx/64608/lib/node_modules/@vizia/app-emulator/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/pantu/.npm/_npx/64608/lib/node_modules/@vizia/app-emulator/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKLyoqCiAqIHlvdSBjYW4gcGFzcyBhbiBvcHRpb25zIG9iamVjdCBpbnRvIHlvdXIgdHJhbnNmb3JtIHdoZW4gaW5zdGFudGlhdGluZyB0aGUgZmFjdG9yeQogKiB0aGVzZSBjYW4gdGhlbiBiZSB1c2VkIGluIHlvdXIgY29kZSBieSBhY2Nlc3MgYG9wdGlvbnMucHJvcE5hbWVgCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICBsZXQgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgcmV0dXJuIHsKICAgIHRyYW5zZm9ybTogKGRhdGEsIHBpcGVsaW5lKSA9PiB7CiAgICAgIGNvbnN0IHByb3BzID0gcGlwZWxpbmUuY29uZmlnLnNjZW5lLm9wdGlvbnM7IC8vZ2V0IGNvbnRyb2wgcHJvcGVydGllcwogICAgICBjb25zdCB7CiAgICAgICAgeVZhbHVlLAogICAgICAgIGZvcm1hdAogICAgICB9ID0gcHJvcHM7IC8vIGdldCB0aGUgdmFsdWVzIHlvdSBuZWVkIGZyb20gY29udHJvbCBwcm9wcwogICAgICBjb25zb2xlLmxvZyh7CiAgICAgICAgZGF0YSwKICAgICAgICBwaXBlbGluZQogICAgICB9KTsKICAgICAgbGV0IGtleU1ldHJpYyA9IHt9OwogICAgICBpZiAoIWRhdGEpIHsKICAgICAgICBrZXlNZXRyaWMgPSB7CiAgICAgICAgICBsYWJlbDogeVZhbHVlLAogICAgICAgICAgdmFsdWU6IDAsCiAgICAgICAgICBmb3JtYXQ6ICdudW1iZXInCiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZyh5VmFsdWUpOwogICAgICAgIGlmICgheVZhbHVlKSB7CiAgICAgICAgICBwaXBlbGluZS5kb25lKCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGtleU1ldHJpYyA9IHsKICAgICAgICAgIGxhYmVsOiB5VmFsdWUuc3BsaXQoJ18nKS5tYXAod29yZCA9PiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKSkuam9pbignICcpLAogICAgICAgICAgdmFsdWU6IGRhdGFbeVZhbHVlXSwKICAgICAgICAgIGNvbXBhcmlzb25WYWx1ZTogZGF0YVtgJHt5VmFsdWV9X2hpc3RvcnlgXSwKICAgICAgICAgIC8vcHJldmlvdXMgZGF0YSBmb3IgdGhlIGNvbXBhcmlzb24KICAgICAgICAgIGZvcm1hdDogeVZhbHVlLmluY2x1ZGVzKCdwZXJjZW50JykgPyAncGVyY2VudCcgOiAnbnVtYmVyJwogICAgICAgIH07CiAgICAgICAgY29uc29sZS5sb2coa2V5TWV0cmljKTsKICAgICAgfQogICAgICBwaXBlbGluZS5wdXNoKGtleU1ldHJpYyk7IC8vcHVzaCB0aGUgZGF0YSBkb3duIHRoZSBwaXBlbGluZQogICAgICBwaXBlbGluZS5kb25lKCk7IC8vbGV0IHRoZSBwaXBlbGluZSBrbm93IHRoYXQgeW91IGhhdmUgZmluaXNoZWQgdHJhbnNmb3JtaW5nIHRoZSBkYXRhCiAgICB9CiAgfTsKfTs="},{"version":3,"names":["module","exports","options","transform","data","pipeline","props","config","scene","yValue","format","console","log","keyMetric","label","value","done","split","map","word","charAt","toUpperCase","slice","join","comparisonValue","includes","push"],"sources":["/Users/pantu/work2/vizia-ig-app/src/lib/create-key-metric-transform.js"],"sourcesContent":["'use strict';\n\n/**\n * you can pass an options object into your transform when instantiating the factory\n * these can then be used in your code by access `options.propName`\n */\nmodule.exports = (options = {}) => {\n    return {\n        transform: (data, pipeline) => {\n            const props = pipeline.config.scene.options; //get control properties\n            const {yValue, format} = props; // get the values you need from control props\n            console.log({data, pipeline});\n            let keyMetric = {};\n            if (!data) {\n                keyMetric = {\n                    label: yValue,\n                    value: 0,\n                    format: 'number'\n                }\n            }\n            else {\n                console.log(yValue);\n                if (!yValue) {\n                    pipeline.done();\n                    return;\n                }\n                keyMetric = {\n                    label: yValue.split('_').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' '), \n                    value: data[yValue], \n                    comparisonValue: data[`${yValue}_history`], //previous data for the comparison\n                    format: yValue.includes('percent') ? 'percent' : 'number'\n                };\n                console.log(keyMetric);\n            }\n            pipeline.push(keyMetric); //push the data down the pipeline\n            pipeline.done(); //let the pipeline know that you have finished transforming the data\n        }\n    };\n};\n"],"mappings":"AAAA,YAAY;;AAEZ;AACA;AACA;AACA;AACAA,MAAM,CAACC,OAAO,GAAG,YAAkB;EAAA,IAAjBC,OAAO,uEAAG,CAAC,CAAC;EAC1B,OAAO;IACHC,SAAS,EAAE,CAACC,IAAI,EAAEC,QAAQ,KAAK;MAC3B,MAAMC,KAAK,GAAGD,QAAQ,CAACE,MAAM,CAACC,KAAK,CAACN,OAAO,CAAC,CAAC;MAC7C,MAAM;QAACO,MAAM;QAAEC;MAAM,CAAC,GAAGJ,KAAK,CAAC,CAAC;MAChCK,OAAO,CAACC,GAAG,CAAC;QAACR,IAAI;QAAEC;MAAQ,CAAC,CAAC;MAC7B,IAAIQ,SAAS,GAAG,CAAC,CAAC;MAClB,IAAI,CAACT,IAAI,EAAE;QACPS,SAAS,GAAG;UACRC,KAAK,EAAEL,MAAM;UACbM,KAAK,EAAE,CAAC;UACRL,MAAM,EAAE;QACZ,CAAC;MACL,CAAC,MACI;QACDC,OAAO,CAACC,GAAG,CAACH,MAAM,CAAC;QACnB,IAAI,CAACA,MAAM,EAAE;UACTJ,QAAQ,CAACW,IAAI,EAAE;UACf;QACJ;QACAH,SAAS,GAAG;UACRC,KAAK,EAAEL,MAAM,CAACQ,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAACC,IAAI,IAAIA,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,EAAE,GAAGF,IAAI,CAACG,KAAK,CAAC,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;UAC5FR,KAAK,EAAEX,IAAI,CAACK,MAAM,CAAC;UACnBe,eAAe,EAAEpB,IAAI,CAAE,GAAEK,MAAO,UAAS,CAAC;UAAE;UAC5CC,MAAM,EAAED,MAAM,CAACgB,QAAQ,CAAC,SAAS,CAAC,GAAG,SAAS,GAAG;QACrD,CAAC;QACDd,OAAO,CAACC,GAAG,CAACC,SAAS,CAAC;MAC1B;MACAR,QAAQ,CAACqB,IAAI,CAACb,SAAS,CAAC,CAAC,CAAC;MAC1BR,QAAQ,CAACW,IAAI,EAAE,CAAC,CAAC;IACrB;EACJ,CAAC;AACL,CAAC"}]}