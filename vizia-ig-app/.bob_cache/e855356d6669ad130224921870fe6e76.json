{"remainingRequest":"/Users/pantu/.npm/_npx/9438/lib/node_modules/@vizia/app-emulator/node_modules/babel-loader/lib/index.js??ref--4-1!/Users/pantu/work2/vizia/src/lib/si-source.js","dependencies":[{"path":"/Users/pantu/work2/vizia/src/lib/si-source.js","mtime":1664803877509},{"path":"/Users/pantu/.npm/_npx/9438/lib/node_modules/@vizia/app-emulator/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/pantu/.npm/_npx/9438/lib/node_modules/@vizia/app-emulator/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKY29uc3QgYXhpb3MgPSByZXF1aXJlKCdheGlvcycpOwoKY29uc3QgewogIHBsYXRmb3JtcywKICBidWlsZEpzb24sCiAgdmFsaWRhdGVBY2NvdW50LAogIHdyaXRlTWFuaWZlc3QKfSA9IHJlcXVpcmUoJy4uL21hbmlmZXN0V3JpdGVyJyk7Cgpjb25zdCBfX0FQSV9BRERSID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6NjAwMS9nb29nbGVkYXRhc3R1ZGlvP21ldGhvZD1wcm9maWxlc19hZ2dyZWdhdGVkX21ldHJpY3MnOyAvLyBjb25zdCBfX0FQSV9BRERSID0gJ2h0dHBzOi8vYXBpLnNvY2lhbGluc2lkZXIuaW8vZ29vZ2xlZGF0YXN0dWRpbz9tZXRob2Q9cHJvZmlsZXNfYWdncmVnYXRlZF9tZXRyaWNzJzsKCmNvbnN0IHBsYXRmb3Jtc0FsaWFzID0gewogICdmYWNlYm9vayc6ICdmYicsCiAgJ2luc3RhZ3JhbSc6ICdpZycsCiAgJ3Rpa3Rvayc6ICd0aycsCiAgJ2xpbmtlZGluJzogJ2xpJywKICAndHdpdHRlcic6ICd0dycsCiAgJ3lvdXR1YmUnOiAneXQnCn07Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICBsZXQgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgcmV0dXJuIHsKICAgIHNvdXJjZShwaXBlbGluZSkgewogICAgICBjb25zdCBwcm9wcyA9IHBpcGVsaW5lLmNvbmZpZy5zY2VuZS5vcHRpb25zOwogICAgICBjb25zdCB7CiAgICAgICAga2V5LAogICAgICAgIHByb2ZpbGUsCiAgICAgICAgcGxhdGZvcm0sCiAgICAgICAgcHJvamVjdAogICAgICB9ID0gcHJvcHM7IC8vIGlmIChrZXkpIHsKICAgICAgLy8gICAgIHZhbGlkYXRlQWNjb3VudChrZXksIChyZXN1bHQpID0+IHsKICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZyh7cmVzdWx0fSk7CiAgICAgIC8vICAgICAgICAgd3JpdGVNYW5pZmVzdChyZXN1bHQpOwogICAgICAvLyAgICAgfSk7CiAgICAgIC8vIH0KCiAgICAgIGNvbnN0IHVybCA9IGAke19fQVBJX0FERFJ9JmtleT0ke2tleX0mcHJvamVjdD0ke3Byb2plY3R9JnBsYXRmb3JtPSR7cGxhdGZvcm1zQWxpYXNbcGxhdGZvcm1dfSZwcm9maWxlcz1beyUyMmlkJTIyOiUyMiR7cHJvZmlsZX0lMjIsJTIycGxhdGZvcm0lMjI6JTIyJHtwbGF0Zm9ybXNBbGlhc1twbGF0Zm9ybV19JTIyfV1gOwogICAgICBjb25zb2xlLmxvZyh1cmwpOwogICAgICBheGlvcyh1cmwpLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuZGF0YSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgcmVzcG9uc2UgPSByZXNwb25zZS5iZW5jaG1hcmtfZGF0YS5maWx0ZXIociA9PiByLm5hbWUgPT09IHByb2ZpbGUpWzBdOwogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICBwaXBlbGluZS5wdXNoKHJlc3BvbnNlKTsKICAgICAgICBwaXBlbGluZS5kb25lKCk7CiAgICAgIH0pOwogICAgfQoKICB9Owp9Ow=="},{"version":3,"names":["axios","require","platforms","buildJson","validateAccount","writeManifest","__API_ADDR","platformsAlias","module","exports","options","source","pipeline","props","config","scene","key","profile","platform","project","url","console","log","then","response","data","benchmark_data","filter","r","name","push","done"],"sources":["/Users/pantu/work2/vizia/src/lib/si-source.js"],"sourcesContent":["'use strict'\nconst axios = require('axios');\nconst { platforms,\n    buildJson,\n    validateAccount,\n    writeManifest }  = require('../manifestWriter');\n\nconst __API_ADDR = 'http://localhost:6001/googledatastudio?method=profiles_aggregated_metrics';\n// const __API_ADDR = 'https://api.socialinsider.io/googledatastudio?method=profiles_aggregated_metrics';\n\nconst platformsAlias = {\n    'facebook': 'fb',\n    'instagram': 'ig',\n    'tiktok': 'tk',\n    'linkedin': 'li',\n    'twitter': 'tw',\n    'youtube': 'yt'\n}\n\nmodule.exports = (options = {}) => {\n    return {\n        source(pipeline) {\n            const props = pipeline.config.scene.options; \n            const {key, profile, platform, project} = props;\n\n            // if (key) {\n            //     validateAccount(key, (result) => {\n            //         console.log({result});\n            //         writeManifest(result);\n            //     });\n            // }\n\n            const url = `${__API_ADDR}&key=${key}&project=${project}&platform=${platformsAlias[platform]}&profiles=[{%22id%22:%22${profile}%22,%22platform%22:%22${platformsAlias[platform]}%22}]`;\n            console.log(url);\n\n            axios(url)\n                .then(response => response.data)\n                .then((response) => {\n                    response = response.benchmark_data.filter(r => r.name === profile)[0];\n                    console.log(response);\n                    pipeline.push(response);\n                    pipeline.done();\n                });\n        }\n    }\n}"],"mappings":"AAAA;;AACA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,MAAM;EAAEC,SAAF;EACFC,SADE;EAEFC,eAFE;EAGFC;AAHE,IAGiBJ,OAAO,CAAC,mBAAD,CAH9B;;AAKA,MAAMK,UAAU,GAAG,2EAAnB,C,CACA;;AAEA,MAAMC,cAAc,GAAG;EACnB,YAAY,IADO;EAEnB,aAAa,IAFM;EAGnB,UAAU,IAHS;EAInB,YAAY,IAJO;EAKnB,WAAW,IALQ;EAMnB,WAAW;AANQ,CAAvB;;AASAC,MAAM,CAACC,OAAP,GAAiB,YAAkB;EAAA,IAAjBC,OAAiB,uEAAP,EAAO;EAC/B,OAAO;IACHC,MAAM,CAACC,QAAD,EAAW;MACb,MAAMC,KAAK,GAAGD,QAAQ,CAACE,MAAT,CAAgBC,KAAhB,CAAsBL,OAApC;MACA,MAAM;QAACM,GAAD;QAAMC,OAAN;QAAeC,QAAf;QAAyBC;MAAzB,IAAoCN,KAA1C,CAFa,CAIb;MACA;MACA;MACA;MACA;MACA;;MAEA,MAAMO,GAAG,GAAI,GAAEd,UAAW,QAAOU,GAAI,YAAWG,OAAQ,aAAYZ,cAAc,CAACW,QAAD,CAAW,2BAA0BD,OAAQ,yBAAwBV,cAAc,CAACW,QAAD,CAAW,OAAhL;MACAG,OAAO,CAACC,GAAR,CAAYF,GAAZ;MAEApB,KAAK,CAACoB,GAAD,CAAL,CACKG,IADL,CACUC,QAAQ,IAAIA,QAAQ,CAACC,IAD/B,EAEKF,IAFL,CAEWC,QAAD,IAAc;QAChBA,QAAQ,GAAGA,QAAQ,CAACE,cAAT,CAAwBC,MAAxB,CAA+BC,CAAC,IAAIA,CAAC,CAACC,IAAF,KAAWZ,OAA/C,EAAwD,CAAxD,CAAX;QACAI,OAAO,CAACC,GAAR,CAAYE,QAAZ;QACAZ,QAAQ,CAACkB,IAAT,CAAcN,QAAd;QACAZ,QAAQ,CAACmB,IAAT;MACH,CAPL;IAQH;;EAvBE,CAAP;AAyBH,CA1BD"}]}