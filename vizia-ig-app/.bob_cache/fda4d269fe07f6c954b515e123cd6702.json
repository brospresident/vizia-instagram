{"remainingRequest":"/Users/pantu/.npm/_npx/5593/lib/node_modules/@vizia/app-emulator/node_modules/babel-loader/lib/index.js??ref--4-1!/Users/pantu/work2/vizia/src/lib/si-source.js","dependencies":[{"path":"/Users/pantu/work2/vizia/src/lib/si-source.js","mtime":1664800890816},{"path":"/Users/pantu/.npm/_npx/5593/lib/node_modules/@vizia/app-emulator/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/pantu/.npm/_npx/5593/lib/node_modules/@vizia/app-emulator/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKY29uc3QgYXhpb3MgPSByZXF1aXJlKCdheGlvcycpOwoKY29uc3QgewogIHBsYXRmb3JtcywKICBidWlsZEpzb24sCiAgdmFsaWRhdGVBY2NvdW50LAogIHdyaXRlTWFuaWZlc3QKfSA9IHJlcXVpcmUoJy4uL21hbmlmZXN0V3JpdGVyJyk7Cgpjb25zdCBfX0FQSV9BRERSID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6NjAwMS9nb29nbGVkYXRhc3R1ZGlvP21ldGhvZD1wcm9maWxlc19hZ2dyZWdhdGVkX21ldHJpY3MnOyAvLyBjb25zdCBfX0FQSV9BRERSID0gJ2h0dHBzOi8vYXBpLnNvY2lhbGluc2lkZXIuaW8vZ29vZ2xlZGF0YXN0dWRpbz9tZXRob2Q9cHJvZmlsZXNfYWdncmVnYXRlZF9tZXRyaWNzJzsKCmNvbnN0IHBsYXRmb3Jtc0FsaWFzID0gewogICdmYWNlYm9vayc6ICdmYicsCiAgJ2luc3RhZ3JhbSc6ICdpZycsCiAgJ3Rpa3Rvayc6ICd0aycsCiAgJ2xpbmtlZGluJzogJ2xpJywKICAndHdpdHRlcic6ICd0dycsCiAgJ3lvdXR1YmUnOiAneXQnCn07Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICBsZXQgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgcmV0dXJuIHsKICAgIHNvdXJjZShwaXBlbGluZSkgewogICAgICBjb25zdCBwcm9wcyA9IHBpcGVsaW5lLmNvbmZpZy5zY2VuZS5vcHRpb25zOwogICAgICBjb25zdCB7CiAgICAgICAga2V5LAogICAgICAgIHByb2ZpbGUsCiAgICAgICAgcGxhdGZvcm0sCiAgICAgICAgcHJvamVjdAogICAgICB9ID0gcHJvcHM7CgogICAgICBpZiAoa2V5KSB7CiAgICAgICAgdmFsaWRhdGVBY2NvdW50KGtleSwgcmVzdWx0ID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKHsKICAgICAgICAgICAgcmVzdWx0CiAgICAgICAgICB9KTsKICAgICAgICAgIHdyaXRlTWFuaWZlc3QocmVzdWx0KTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgY29uc3QgdXJsID0gYCR7X19BUElfQUREUn0ma2V5PSR7a2V5fSZwcm9qZWN0PSR7cHJvamVjdH0mcGxhdGZvcm09JHtwbGF0Zm9ybXNBbGlhc1twbGF0Zm9ybV19JnByb2ZpbGVzPVt7JTIyaWQlMjI6JTIyJHtwcm9maWxlfSUyMiwlMjJwbGF0Zm9ybSUyMjolMjIke3BsYXRmb3Jtc0FsaWFzW3BsYXRmb3JtXX0lMjJ9XWA7CiAgICAgIGNvbnNvbGUubG9nKHVybCk7CiAgICAgIGF4aW9zKHVybCkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5kYXRhKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICByZXNwb25zZSA9IHJlc3BvbnNlLmJlbmNobWFya19kYXRhLmZpbHRlcihyID0+IHIubmFtZSA9PT0gcHJvZmlsZSlbMF07CiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgIHBpcGVsaW5lLnB1c2gocmVzcG9uc2UpOwogICAgICAgIHBpcGVsaW5lLmRvbmUoKTsKICAgICAgfSk7CiAgICB9CgogIH07Cn07"},{"version":3,"names":["axios","require","platforms","buildJson","validateAccount","writeManifest","__API_ADDR","platformsAlias","module","exports","options","source","pipeline","props","config","scene","key","profile","platform","project","result","console","log","url","then","response","data","benchmark_data","filter","r","name","push","done"],"sources":["/Users/pantu/work2/vizia/src/lib/si-source.js"],"sourcesContent":["'use strict'\nconst axios = require('axios');\nconst { platforms,\n    buildJson,\n    validateAccount,\n    writeManifest }  = require('../manifestWriter');\n\nconst __API_ADDR = 'http://localhost:6001/googledatastudio?method=profiles_aggregated_metrics';\n// const __API_ADDR = 'https://api.socialinsider.io/googledatastudio?method=profiles_aggregated_metrics';\n\nconst platformsAlias = {\n    'facebook': 'fb',\n    'instagram': 'ig',\n    'tiktok': 'tk',\n    'linkedin': 'li',\n    'twitter': 'tw',\n    'youtube': 'yt'\n}\n\nmodule.exports = (options = {}) => {\n    return {\n        source(pipeline) {\n            const props = pipeline.config.scene.options; \n            const {key, profile, platform, project} = props;\n\n            if (key) {\n                validateAccount(key, (result) => {\n                    console.log({result});\n                    writeManifest(result);\n                });\n            }\n\n            const url = `${__API_ADDR}&key=${key}&project=${project}&platform=${platformsAlias[platform]}&profiles=[{%22id%22:%22${profile}%22,%22platform%22:%22${platformsAlias[platform]}%22}]`;\n            console.log(url);\n\n            axios(url)\n                .then(response => response.data)\n                .then((response) => {\n                    response = response.benchmark_data.filter(r => r.name === profile)[0];\n                    console.log(response);\n                    pipeline.push(response);\n                    pipeline.done();\n                });\n        }\n    }\n}"],"mappings":"AAAA;;AACA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,MAAM;EAAEC,SAAF;EACFC,SADE;EAEFC,eAFE;EAGFC;AAHE,IAGiBJ,OAAO,CAAC,mBAAD,CAH9B;;AAKA,MAAMK,UAAU,GAAG,2EAAnB,C,CACA;;AAEA,MAAMC,cAAc,GAAG;EACnB,YAAY,IADO;EAEnB,aAAa,IAFM;EAGnB,UAAU,IAHS;EAInB,YAAY,IAJO;EAKnB,WAAW,IALQ;EAMnB,WAAW;AANQ,CAAvB;;AASAC,MAAM,CAACC,OAAP,GAAiB,YAAkB;EAAA,IAAjBC,OAAiB,uEAAP,EAAO;EAC/B,OAAO;IACHC,MAAM,CAACC,QAAD,EAAW;MACb,MAAMC,KAAK,GAAGD,QAAQ,CAACE,MAAT,CAAgBC,KAAhB,CAAsBL,OAApC;MACA,MAAM;QAACM,GAAD;QAAMC,OAAN;QAAeC,QAAf;QAAyBC;MAAzB,IAAoCN,KAA1C;;MAEA,IAAIG,GAAJ,EAAS;QACLZ,eAAe,CAACY,GAAD,EAAOI,MAAD,IAAY;UAC7BC,OAAO,CAACC,GAAR,CAAY;YAACF;UAAD,CAAZ;UACAf,aAAa,CAACe,MAAD,CAAb;QACH,CAHc,CAAf;MAIH;;MAED,MAAMG,GAAG,GAAI,GAAEjB,UAAW,QAAOU,GAAI,YAAWG,OAAQ,aAAYZ,cAAc,CAACW,QAAD,CAAW,2BAA0BD,OAAQ,yBAAwBV,cAAc,CAACW,QAAD,CAAW,OAAhL;MACAG,OAAO,CAACC,GAAR,CAAYC,GAAZ;MAEAvB,KAAK,CAACuB,GAAD,CAAL,CACKC,IADL,CACUC,QAAQ,IAAIA,QAAQ,CAACC,IAD/B,EAEKF,IAFL,CAEWC,QAAD,IAAc;QAChBA,QAAQ,GAAGA,QAAQ,CAACE,cAAT,CAAwBC,MAAxB,CAA+BC,CAAC,IAAIA,CAAC,CAACC,IAAF,KAAWb,OAA/C,EAAwD,CAAxD,CAAX;QACAI,OAAO,CAACC,GAAR,CAAYG,QAAZ;QACAb,QAAQ,CAACmB,IAAT,CAAcN,QAAd;QACAb,QAAQ,CAACoB,IAAT;MACH,CAPL;IAQH;;EAvBE,CAAP;AAyBH,CA1BD"}]}