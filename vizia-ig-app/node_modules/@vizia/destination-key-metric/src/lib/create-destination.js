'use strict';

const resolveProps = require('@vizia/resolve-props');

const App = require('./app');

/**
 * Destination factory, manages app instance and pipeline pushes
 */
function createDestination(options) {
    const app = new App();

    return {
        destination(data, pipeline) {
            const props = resolveProps(pipeline.config, options);

            app.updateConfig(props);
            app.updateData(data);

            pipeline.done();
        }
    };
}

module.exports = createDestination;
