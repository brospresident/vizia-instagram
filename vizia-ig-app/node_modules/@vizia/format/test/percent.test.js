'use strict';

const test = require('ava');

const viziaFormat = require('../src');

/**
 * Percent default behaviour
 */

test('Percent defaults: Int', (t) => {
    t.is(
        viziaFormat(1, {format: 'percent'}),
        '100%',
        'renders as percent'
    );
});

test('Percent defaults: Float with 2 decimal points', (t) => {
    t.is(
        viziaFormat(1.23, {format: 'percent'}),
        '123%',
        'renders as percent with no decimal point'
    );
});

test('Percent defaults: Float with 3 decimal points', (t) => {
    t.is(
        viziaFormat(12.341, {format: 'percent'}),
        '1,234.1%',
        'renders as positive percent with 1 decimal point'
    );
});

test('Percent defaults: Float with more than 3 decimal points', (t) => {
    t.is(
        viziaFormat(12.341234, {format: 'percent'}),
        '1,234.12%',
        'renders as positive percent with 2 decimal points'
    );
});

test('Percent defaults: Negative float', (t) => {
    t.is(
        viziaFormat(-12.341234, {format: 'percent'}),
        '−1,234.12%',
        'renders as negative percent with 2 decimal points'
    );
});

test('Percent defaults: Large positive float', (t) => {
    t.is(
        viziaFormat(123.41234, {format: 'percent'}),
        '12.34K%',
        'renders as positive abbreviated percent with 2 decimal points'
    );
});

test('Percent defaults: Large negative float', (t) => {
    t.is(
        viziaFormat(-123.41234, {format: 'percent'}),
        '−12.34K%',
        'renders as negative abbreviated percent with 2 decimal points'
    );
});

test('Percent defaults: Float equal to the default abbreviated threshold', (t) => {
    t.is(
        viziaFormat(99.995, {format: 'percent'}),
        '10K%',
        'renders as abbreviated percent'
    );
});

/**
 * Percent overrides
 */
test('Percent: Using custom mantissa', (t) => {
    t.is(
        viziaFormat(0.1234, {format: 'percent', mantissa: 0}),
        '12%',
        'renders as percent with no decimal point'
    );
});

test('Percent: Setting trimMantissa=false', (t) => {
    t.is(
        viziaFormat(0.123, {format: 'percent', trimMantissa: false}),
        '12.30%',
        'renders as percent with 2 decimal points'
    );
});

test('Percent: Setting abbr=false', (t) => {
    t.is(
        viziaFormat(123.45, {format: 'percent', abbr: false}),
        '12,345%',
        'renders as unabbreviated percent'
    );
});

test('Percent: Using custom abbrThreshold', (t) => {
    t.is(
        viziaFormat(9.99, {format: 'percent', abbrThreshold: 1000}),
        '999%',
        'renders as unabbreviated percent'
    );
    t.is(
        viziaFormat(10, {format: 'percent', abbrThreshold: 1000}),
        '1K%',
        'renders as abbreviated percent'
    );
});
